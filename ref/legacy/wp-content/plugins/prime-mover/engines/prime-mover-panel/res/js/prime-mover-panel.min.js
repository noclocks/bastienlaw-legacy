!function(c){c(function(){p.deleteAllBackups(),p.computeBackupDirSize(),p.showHideAuthorizationKeys(),p.showHideGDriveCredentials(),p.toggleDropBoxToken(),p.toggleEncryptionKey(),p.toggleMySQLDumpConfigPath(),p.clearLogs(),p.initializeAjaxHandlers(),p.resetToDefaults(),p.generateAuthorizationKey(),p.copyKeyToClipBoard(),p.copyEncryptionKeyToClipBoard(),p.slideTogglerActivatedPlugins()});var p={initializeData:[{button_selector:"#js-save-prime_mover_dbdump_batchsize",spinner_selector:".js-save-prime_mover_dbdump_batchsize-spinner",data_selector:"#js-prime_mover_dbdump_batchsize",ajax_action:"prime_mover_dbdump_batchsize",ajax_key:"prime_mover_dbdump_batchsize_key",datatype:"text",dialog:!1},{button_selector:"#js-save-prime_mover_searchreplace_batchsize",spinner_selector:".js-save-prime_mover_searchreplace_batchsize-spinner",data_selector:"#js-prime_mover_searchreplace_batchsize",ajax_action:"prime_mover_searchreplace_batchsize",ajax_key:"prime_mover_searchreplace_batchsize_key",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-upload-chunk-size",spinner_selector:".js-save-prime-mover-upload-chunk-size-spinner",data_selector:"#js-prime_mover_upload_chunksize",ajax_action:"prime_mover_save_uploadchunksize_settings",ajax_key:"uploadchunksize",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-enable-js-uploadlog",spinner_selector:".js-save-prime-mover-enable-js-uploadlog-spinner",data_selector:"#js-prime_mover_enable_js_uploadlog_checkbox",ajax_action:"prime_mover_save_uploadjs_troubleshooting_setting",ajax_key:prime_mover_control_panel_renderer.enable_uploadjs_troubleshooting,datatype:"checkbox",dialog:!1},{button_selector:"#js-save-prime-mover-enable-turbomode",spinner_selector:".js-save-prime-mover-enable-turbomode-spinner",data_selector:"#js-prime_mover_enable_js_turbomode_checkbox",ajax_action:"prime_mover_save_turbomode_setting",ajax_key:prime_mover_control_panel_renderer.enable_turbo_mode,datatype:"checkbox",dialog:!1},{button_selector:"#js-save-prime-mover-enable-js-log",spinner_selector:".js-save-prime-mover-enable-js-log-spinner",data_selector:"#js-prime_mover_enable_js_log_checkbox",ajax_action:"prime_mover_save_js_troubleshooting_settings",ajax_key:prime_mover_control_panel_renderer.enable_js_troubleshooting,datatype:"checkbox",dialog:!1},{button_selector:"#js-save-prime-mover-persist-troubleshooting",spinner_selector:".js-save-prime-mover-persist-troubleshooting-spinner",data_selector:"#js-prime_mover_persist_log_checkbox",ajax_action:"prime_mover_save_persist_troubleshooting_settings",ajax_key:prime_mover_control_panel_renderer.enable_persist_troubleshooting,datatype:"checkbox",dialog:!1},{button_selector:"#js-save-prime-mover-troubleshooting",spinner_selector:".js-save-prime-mover-troubleshooting-spinner",data_selector:"#js-prime_mover_enable_log_checkbox",ajax_action:"prime_mover_save_troubleshooting_settings",ajax_key:prime_mover_control_panel_renderer.enable_troubleshooting,datatype:"checkbox",dialog:!1},{button_selector:"#js-save-prime-mover-dropbox-access-token",spinner_selector:".js-save-prime-mover-dropbox-access-token-spinner",data_selector:"#js-prime_mover_dropbox_access_key",ajax_action:"prime_mover_save_dropbox_settings",ajax_key:"dropbox_access_token",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-encryption-key",spinner_selector:".js-save-prime-mover-encryption-key-spinner",data_selector:"#js-prime_mover_encryption_key_panel",ajax_action:"prime_mover_write_key_to_config",ajax_key:"prime_mover_encryption_ajax_key",datatype:"text",dialog:!0,dialog_selector:"#js-prime-mover-panel-enc-warn-dialog",dialog_button_text:prime_mover_control_panel_renderer.prime_mover_update_enc_key_button},{button_selector:"#js-save-prime-mover-excluded-plugins",spinner_selector:".js-save-prime-mover-excluded-plugins-spinner",data_selector:"#js-prime-mover-excluded-plugins",ajax_action:"prime_mover_excluded_plugins",ajax_key:"text_area_data",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-excluded-uploads",spinner_selector:".js-save-prime-mover-excluded-uploads-spinner",data_selector:"#js-prime-mover-excluded-uploads",ajax_action:"prime_mover_excluded_uploads",ajax_key:"text_area_data",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-custom-basebackup-dir",spinner_selector:".js-prime_mover_basedirsettings_spinner",data_selector:"#js-prime_mover_user_backup_dir_setting",ajax_action:"prime_mover_save_custom_baseabackup_dir",ajax_key:"custom_path",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-maintenance-mode",spinner_selector:".js-prime_mover_maintenance-mode-spinner",data_selector:"#js-prime_mover_enable_maintenance_mode",ajax_action:"prime_mover_save_maintenance_mode_setting",ajax_key:"turn_off_maintenance",datatype:"checkbox",dialog:!1},{button_selector:"#js-save-prime-mover-download-authentication",spinner_selector:".js-prime_mover_download_authentication-spinner",data_selector:"#js-prime-mover-authorized-domains",ajax_action:"prime_mover_save_download_authentication",ajax_key:"text_area_data",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-gdrive-setting",spinner_selector:".js-prime_mover_gdrive_setting-spinner",data_selector:"#js-prime-mover-gdrive-settings",ajax_action:"prime_mover_save_gdrive_setting",ajax_key:"text_area_data",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-refreshinterval-size",spinner_selector:".js-save-prime-mover-upload-refreshinterval-spinner",data_selector:"#js-prime_mover_upload_refreshinterval",ajax_action:"prime_mover_save_upload_refresh_interval",ajax_key:"refresh_interval_setting",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-upload-retrylimit",spinner_selector:".js-save-prime-mover-upload-retrylimit-spinner",data_selector:"#js-prime_mover_upload_retrylimit",ajax_action:"prime_mover_save_upload_retrylimit",ajax_key:"upload_retry_limit",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-dropbox-chunk-size",spinner_selector:".js-save-prime-mover-dropbox-chunk-size-spinner",data_selector:"#js-prime_mover_dropbox_chunksize",ajax_action:"prime_mover_save_dropbox_chunksize_setting",ajax_key:"dropbox_chunk_upload_size",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-gdrive-chunk-size",spinner_selector:".js-save-prime-mover-gdrive-chunk-size-spinner",data_selector:"#js-prime_mover_gdrive_chunksize",ajax_action:"prime_mover_save_gdrive_chunksize_setting",ajax_key:"gdrive_chunk_upload_size",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-gdrivedownload-chunk-size",spinner_selector:".js-save-prime-mover-gdrivedownload-chunk-size-spinner",data_selector:"#js-prime_mover_gdrivedownload_chunksize",ajax_action:"prime_mover_save_gdrivedownload_chunksize_setting",ajax_key:"gdrive_chunk_download_size",datatype:"text",dialog:!1},{button_selector:"#js-save-prime-mover-mysqldump-cnf-setting",spinner_selector:".js-save-prime-mover-mysqldump-cnf-setting-spinner",data_selector:"#js-prime_mover_mysqldump_cnf_setting",ajax_action:"prime_mover_save_mysqldump_settings",ajax_key:"mysqldump_cnf_path",datatype:"text",dialog:!1}],initializeAjaxHandlers:function(){c.each(this.initializeData,function(e,t){c("body").on("click",t.button_selector,function(){var e,o=t.spinner_selector;"text"===t.datatype&&(e=c(t.data_selector).val()),"checkbox"===t.datatype&&(e=!1,c(t.data_selector).is(":checked")&&(e=!0));var r,a=c(this).attr("data-nonce");!0===t.dialog?(r=t.dialog_selector,p.showDialogHandler(r,a,t.dialog_button_text,"prime-mover-deleteall-button",o,t.ajax_action,t.ajax_key,e,prime_mover_control_panel_renderer.prime_mover_cancel_button,t.data_selector)):p.isDoingAjax(o)||(p.triggerProcessing(o),(a=p.defineGenericData(t.ajax_action,a))[t.ajax_key]=e,p.doAjaxRequest(a,o,t.data_selector))})})},showDialogHandler:function(e,r,o,a,t,i,n,s,_,l){void 0===l&&(l=""),c(e).dialog({resizable:!1,height:"auto",minWidth:320,maxWidth:600,dialogClass:"prime-mover-user-dialog",modal:!0,fluid:!0,buttons:[{text:o,class:a,click:function(){c(this).dialog("close");var e=t;p.triggerProcessing(e);var o=p.defineGenericData(i,r);o[n]=s,p.doAjaxRequest(o,e,l)}},{text:_,click:function(){c(this).dialog("close")}}]}),p.handle_responsive_dialog()},doAjaxRequest:function(e,t,r){void 0===r&&(r=""),p.doing_ajax[t]=!0,c.post(ajaxurl,e,function(e){var o;c(t).html(e.message),"saved_settings"in e&&r&&(o=e.saved_settings,p.executeOtherAfterSavedHooks(r,o),c(r).val(o)),e.save_status?c(t).addClass("notice notice-success"):o?c(t).addClass("notice notice-warning"):c(t).addClass("notice notice-error"),p.doing_ajax[t]=!1,"reload"in e&&!0===e.reload&&location.reload()}).fail(function(e,o,r){var a=prime_mover_control_panel_renderer.prime_mover_panel_error;r&&o&&(a=(o=o.toUpperCase())+": "+r),c(t).html(a),c(t).addClass("notice notice-error"),p.doing_ajax[t]=!1})},doing_ajax:[],isDoingAjax:function(e){return e in p.doing_ajax&&p.doing_ajax[e]},toggleDropBoxToken:function(){var o="#js-prime_mover_dropbox_access_key";c("body").on("click","#js-prime_mover_dropbox_token_checkbox",function(){var e="conceal-authorization-keys";c(o).hasClass(e)?c(o).removeClass(e):c(o).addClass(e)})},toggleEncryptionKey:function(){var o="#js-prime_mover_encryption_key_panel";c("body").on("click","#js-prime_mover_encryption_key_panel_checkbox",function(){var e="conceal-authorization-keys";c(o).hasClass(e)?c(o).removeClass(e):c(o).addClass(e)})},toggleMySQLDumpConfigPath:function(){var o="#js-prime_mover_mysqldump_cnf_setting";c("body").on("click","#js-prime_mover_mysqldump_cnf_checkbox",function(){var e="conceal-authorization-keys";c(o).hasClass(e)?c(o).removeClass(e):c(o).addClass(e)})},showHideAuthorizationKeys:function(){var e="#js-prime-mover-authorized-domains",o="conceal-authorization-keys";c("body").on("click","#js-prime_mover_edit_authorization_keys",function(){c(e).hasClass(o)?c(e).removeClass(o):c(e).addClass(o)})},showHideGDriveCredentials:function(){var e="#js-prime-mover-gdrive-settings",o="conceal-authorization-keys";c("body").on("click","#js-prime_mover_edit_gdrive",function(){c(e).hasClass(o)?c(e).removeClass(o):c(e).addClass(o)})},generateAuthorizationKey:function(){c("body").on("click","#js-prime-mover-autogenerate-key",function(){for(var e=prime_mover_control_panel_renderer.prime_mover_host_domain,o=e+":"+p.randomString(),r=".js-prime-mover-copy-key",a="#js-prime-mover-authorized-domains",t=c.trim(c(a).val()).replace(/ /g,"").split("\n").filter(function(e){return 0!==e.length&&null!==e}),i=t.length,n=[],s=0;s<i;s++){var _=t[s];-1!==_.indexOf(":")&&(_=_.split(":")[0],n.push(_),_===e&&(p.authorizationKeyClipBoardHandler(r,o),t[s]=o))}-1===c.inArray(e,n)&&(p.authorizationKeyClipBoardHandler(r,o),t.push(o));var l=t.join("\n");c(a).val(l)})},authorizationKeyClipBoardHandler:function(e,o){var r=c(e).attr("data-saved-value");c(e).attr("data-clipboard-text",o),r!==o&&c(".js-prime-mover-copy-key").hide()},copyKeyToClipBoard:function(){this.clipBoardHelper(".js-prime-mover-copy-key","#js-prime-mover-clipboard-key-confirmation")},copyEncryptionKeyToClipBoard:function(){this.clipBoardHelper(".js-prime-mover-copy-encryption-key","#js-prime-mover-clipboard-encryption-key-confirmation")},clipBoardHelper:function(e,o){new ClipboardJS(e).on("success",function(e){c(o).fadeIn("fast").delay(3e3).fadeOut()})},randomString:function(){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",o="",r=64;0<r;--r)o+=e[Math.floor(Math.random()*e.length)];return o},triggerProcessing:function(e){var o='<img src="'+prime_mover_control_panel_renderer.prime_mover_settings_ajax_spinner_gif+'" />';c(e).html(o),c(e).removeClass("notice notice-error"),c(e).removeClass("notice notice-success"),c(e).removeClass("notice notice-warning")},computeBackupDirSize:function(){c("body").on("click","#js-prime-mover-backup-directory-size-button",function(){var e,o=".js-prime-mover-backup-directory-size-spinner";p.isDoingAjax(o)||(p.triggerProcessing(o),e=c(this).attr("data-nonce"),(e=p.defineGenericData("prime_mover_computedir_size",e)).compute_dir_size="yes",p.doAjaxRequest(e,o))})},clearLogs:function(){c("body").on("click","#js-clear-prime-mover-troubleshooting",function(){var e=c(this).attr("data-nonce");p.showDialogHandler("#js-prime-mover-panel-clearall-dialog",e,prime_mover_control_panel_renderer.prime_mover_clearall_button,"prime-mover-deleteall-button",".js-save-prime-mover-clear-log-spinner","prime_mover_clear_troubleshooting_log","clear_confirmation","clearlog",prime_mover_control_panel_renderer.prime_mover_cancel_button)})},deleteAllBackups:function(){c("body").on("click","#js-delete_all_backup_zips_network",function(){var e=c(this).attr("data-nonce");p.showDialogHandler("#js-prime-mover-panel-deleteall-dialog",e,prime_mover_control_panel_renderer.prime_mover_delete_continue_button,"prime-mover-deleteall-button",".js-delete_all_backup_zips_network-spinner","prime_mover_delete_all_backups_request","delete_confirmation","yes",prime_mover_control_panel_renderer.prime_mover_cancel_button)})},resetToDefaults:function(){c("body").on("click","#js-prime-mover-reset-settings",function(){var e=c(this).attr("data-nonce");p.showDialogHandler("#js-prime-mover-panel-resettodefault-dialog",e,prime_mover_control_panel_renderer.prime_mover_delete_continue_button,"prime-mover-deleteall-button",".js-reset-back-to-defaults-migration-spinner","prime_mover_reset_settings","reset_confirmation","yes",prime_mover_control_panel_renderer.prime_mover_cancel_button)})},fluidDialog:function(){c(".ui-dialog:visible").each(function(){var e,o=c(this),r=o.find(".ui-dialog-content").data("ui-dialog");r.options.fluid&&(c(window).width()<parseInt(r.options.maxWidth)+50?o.css("max-width","90%"):(e=.9*parseInt(r.options.maxWidth),o.css("max-width",e+"px")),r.option("position",r.options.position))})},handle_responsive_dialog:function(){c(window).resize(function(){p.fluidDialog()}),p.fluidDialog()},defineGenericData:function(e,o){return{action:e,dataType:"json",savenonce:o}},executeOtherAfterSavedHooks:function(e,o){"#js-prime-mover-authorized-domains"===e&&p.showClipBoardButtonWhenSiteKeyExist(o)},slideTogglerActivatedPlugins:function(){var e="#js-prime-mover-toggle-activated-plugins";c("body").on("click",e,function(){c("#js-prime-mover-activated-plugins-helper").slideToggle("fast",function(){c(this).is(":visible")?c(e).text(prime_mover_control_panel_renderer.prime_mover_close_text):c(e).text(prime_mover_control_panel_renderer.prime_mover_expand_text)})}),c("#js-prime-mover-activated-plugins-helper input:checkbox").change(function(){var e=c("#js-prime-mover-activated-plugins-helper input:checkbox:checked").map(function(){return c(this).val()}).get().join("\n");c("#js-prime-mover-excluded-plugins").val(e)})},showClipBoardButtonWhenSiteKeyExist:function(e){var o=!1,e=c.trim(e);if(e){for(var r=prime_mover_control_panel_renderer.prime_mover_host_domain,a=e.split("\n").filter(function(e){return 0!==e.length&&null!==e}),t=a.length,i=0;i<t;i++){var n=a[i];-1!==n.indexOf(":")&&n.split(":")[0]===r&&(o=!0,c(".js-prime-mover-copy-key").show())}!1===o&&c(".js-prime-mover-copy-key").hide()}else c(".js-prime-mover-copy-key").hide()}}}(jQuery);